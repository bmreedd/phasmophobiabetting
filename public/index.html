<!DOCTYPE html>
<script>
    // Log when the socket connects
    const socket = io();
    socket.on('connect', () => {
        console.log('Connected to server with id:', socket.id);
    });

    let username = "";
    let isModerator = false;
    
    function registerUser() {
        username = document.getElementById('username').value;
        if (!username) return;
        console.log('Registering user:', username);  // Debug log

        socket.emit('register', username);
        document.getElementById('login-container').classList.add('hidden');
        document.getElementById('game-container').classList.remove('hidden');
        document.getElementById('player-name').innerText = username;
    }
    
    // Existing functions...
    function startRound() {
        if (isModerator) socket.emit('startGame', 0);
    }

    function endRound() {
        if (isModerator) {
            let outcome = document.getElementById('round-outcome').value;
            socket.emit('endRound', outcome);
        }
    }

    function submitBets() {
        let betAmount = prompt("Enter bet amount:");
        let betChoice = prompt("Enter your bet choice:");
        if (betAmount && betChoice) {
            socket.emit('placeBet', { username, amount: parseInt(betAmount), choice: betChoice });
        }
    }
    
    socket.on('updatePlayers', (players) => {
        console.log('Players updated:', players); // Debug log
        if (players[username]) {
            document.getElementById('gold-balance').innerText = players[username].balance;
        }
    });

    socket.on('moderatorSet', (mod) => {
        if (mod === username) {
            isModerator = true;
            document.getElementById('moderator-controls').classList.remove('hidden');
        }
    });

    socket.on('updateBets', (bets, totalPot) => {
        console.log('Bets updated:', bets, 'Total Pot:', totalPot); // Debug log
        let betList = document.getElementById('bet-list');
        betList.innerHTML = "";
        for (let player in bets) {
            let betItem = document.createElement('li');
            betItem.innerText = `${player} bet ${bets[player].amount} on ${bets[player].choice}`;
            betList.appendChild(betItem);
        }
    });
